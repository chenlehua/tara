{
  "control_measures": [
    {
      "id": "CM-IVI-001",
      "threat_ids": ["THR-IVI-001", "THR-IVI-002"],
      "name": "SELinux强制访问控制",
      "control_type": "prevention",
      "category": "访问控制",
      "description": "启用SELinux enforcing模式，严格限制应用和进程的系统访问权限",
      "implementation": "配置SELinux策略限制应用访问内核接口和敏感资源，实施最小权限原则",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-15",
      "verification": "渗透测试验证提权攻击无法突破SELinux限制"
    },
    {
      "id": "CM-IVI-002",
      "threat_ids": ["THR-IVI-001"],
      "name": "应用沙箱隔离",
      "control_type": "prevention",
      "category": "隔离",
      "description": "使用容器技术和应用沙箱隔离第三方应用，防止恶意应用访问系统资源",
      "implementation": "部署Android应用沙箱，使用seccomp限制系统调用，隔离应用数据目录",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-16",
      "verification": "应用逃逸测试验证隔离有效性"
    },
    {
      "id": "CM-IVI-003",
      "threat_ids": ["THR-IVI-001", "THR-IVI-020"],
      "name": "安全补丁管理",
      "control_type": "corrective",
      "category": "漏洞管理",
      "description": "建立漏洞响应机制，及时发布和应用安全补丁",
      "implementation": "建立CVE监控流程，月度安全补丁评估，OTA快速推送关键补丁",
      "effectiveness": "medium",
      "cost": "medium",
      "priority": 1,
      "status": "in_progress",
      "iso21434_ref": "RQ-09-17",
      "verification": "漏洞修复时间SLA跟踪"
    },
    {
      "id": "CM-IVI-004",
      "threat_ids": ["THR-IVI-002"],
      "name": "Hypervisor安全加固",
      "control_type": "prevention",
      "category": "虚拟化安全",
      "description": "加固QNX Hypervisor配置，实施VM间严格隔离",
      "implementation": "配置VM内存隔离、限制虚拟设备访问、启用SMMU/IOMMU保护",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-30",
      "verification": "虚拟化逃逸测试"
    },
    {
      "id": "CM-IVI-005",
      "threat_ids": ["THR-IVI-003", "THR-IVI-020"],
      "name": "安全启动验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "实施完整的安全启动链，验证所有启动阶段固件签名",
      "implementation": "HSM存储根密钥，逐级验证Boot ROM→SPL→U-Boot→OS签名，启用防回滚",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-04",
      "verification": "篡改固件启动失败验证"
    },
    {
      "id": "CM-IVI-006",
      "threat_ids": ["THR-IVI-003"],
      "name": "防故障注入加固",
      "control_type": "prevention",
      "category": "硬件安全",
      "description": "实施防故障注入措施，检测电压和时钟异常",
      "implementation": "启用电压监测传感器、时钟异常检测、关键操作双重执行验证",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-25",
      "verification": "故障注入攻击测试"
    },
    {
      "id": "CM-IVI-007",
      "threat_ids": ["THR-IVI-004"],
      "name": "DMS多传感器融合",
      "control_type": "prevention",
      "category": "完整性",
      "description": "使用多传感器数据融合验证DMS检测结果，检测对抗攻击",
      "implementation": "结合摄像头、红外和方向盘传感器数据，异常时触发降级处理",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-13",
      "verification": "对抗样本测试"
    },
    {
      "id": "CM-IVI-008",
      "threat_ids": ["THR-IVI-005", "THR-IVI-006"],
      "name": "摄像头/麦克风访问控制",
      "control_type": "prevention",
      "category": "隐私保护",
      "description": "严格控制应用对摄像头和麦克风的访问权限，提供物理隐私指示",
      "implementation": "运行时权限管理，LED指示灯显示录制状态，用户可随时禁用",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-40",
      "verification": "权限绕过测试"
    },
    {
      "id": "CM-IVI-009",
      "threat_ids": ["THR-IVI-005", "THR-IVI-006"],
      "name": "隐私数据加密存储",
      "control_type": "prevention",
      "category": "加密",
      "description": "对摄像头录像、语音数据等隐私内容进行加密存储",
      "implementation": "使用AES-256-GCM加密存储，密钥由用户凭证派生",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-11",
      "verification": "数据提取测试验证加密有效"
    },
    {
      "id": "CM-IVI-010",
      "threat_ids": ["THR-IVI-007"],
      "name": "WiFi安全加固",
      "control_type": "prevention",
      "category": "网络安全",
      "description": "实施WiFi安全最佳实践，防止恶意热点连接",
      "implementation": "强制WPA3加密，实施证书验证，禁用自动连接未知热点",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-09",
      "verification": "恶意AP测试"
    },
    {
      "id": "CM-IVI-011",
      "threat_ids": ["THR-IVI-008", "THR-IVI-014"],
      "name": "蓝牙安全配对",
      "control_type": "prevention",
      "category": "加密",
      "description": "强制使用安全配对模式，实施设备认证",
      "implementation": "启用Secure Simple Pairing (SSP)，使用LE Secure Connections，验证设备证书",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-09",
      "verification": "蓝牙欺骗测试"
    },
    {
      "id": "CM-IVI-012",
      "threat_ids": ["THR-IVI-009", "THR-IVI-022"],
      "name": "双向TLS认证",
      "control_type": "prevention",
      "category": "认证",
      "description": "车辆与云端通信使用mTLS双向认证，防止中间人攻击",
      "implementation": "部署TLS 1.3+mTLS，HSM存储客户端证书，实施证书固定(Certificate Pinning)",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-01",
      "verification": "MITM攻击测试"
    },
    {
      "id": "CM-IVI-013",
      "threat_ids": ["THR-IVI-009"],
      "name": "服务器证书固定",
      "control_type": "prevention",
      "category": "认证",
      "description": "固定云端服务器证书指纹，防止证书伪造",
      "implementation": "应用内置CA证书指纹，拒绝未知CA颁发的证书",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-02",
      "verification": "伪造证书连接测试"
    },
    {
      "id": "CM-IVI-014",
      "threat_ids": ["THR-IVI-010"],
      "name": "蜂窝通信冗余",
      "control_type": "resilience",
      "category": "可用性",
      "description": "关键服务支持多通道备份，降低单点干扰影响",
      "implementation": "支持蜂窝/WiFi自动切换，紧急呼叫优先使用卫星通信备份",
      "effectiveness": "medium",
      "cost": "medium",
      "priority": 2,
      "status": "planned",
      "iso21434_ref": "RQ-09-14",
      "verification": "干扰环境功能测试"
    },
    {
      "id": "CM-IVI-015",
      "threat_ids": ["THR-IVI-011"],
      "name": "GNSS信号验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "多源定位数据融合，检测GPS欺骗",
      "implementation": "融合GNSS/惯性导航/轮速数据，检测位置跳变异常",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-35",
      "verification": "GPS欺骗检测测试"
    },
    {
      "id": "CM-IVI-016",
      "threat_ids": ["THR-IVI-012"],
      "name": "V2X消息签名验证",
      "control_type": "prevention",
      "category": "认证",
      "description": "验证V2X消息的数字签名，拒绝未认证消息",
      "implementation": "实施SCMS PKI架构，验证BSM消息签名，检测证书撤销列表",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-36",
      "verification": "伪造V2X消息测试"
    },
    {
      "id": "CM-IVI-017",
      "threat_ids": ["THR-IVI-012"],
      "name": "V2X消息合理性检查",
      "control_type": "prevention",
      "category": "完整性",
      "description": "检查V2X消息内容的合理性，过滤异常消息",
      "implementation": "验证消息中的位置、速度、时间戳等字段合理性",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-37",
      "verification": "异常消息过滤测试"
    },
    {
      "id": "CM-IVI-018",
      "threat_ids": ["THR-IVI-013"],
      "name": "UWB防中继机制",
      "control_type": "prevention",
      "category": "认证",
      "description": "利用UWB精确测距检测中继攻击",
      "implementation": "ToF时间戳验证，检测异常延迟，多锚点定位交叉验证",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-38",
      "verification": "中继攻击测试"
    },
    {
      "id": "CM-IVI-019",
      "threat_ids": ["THR-IVI-013", "THR-IVI-014"],
      "name": "数字钥匙多因素认证",
      "control_type": "prevention",
      "category": "认证",
      "description": "数字钥匙使用多因素认证，防止单点突破",
      "implementation": "UWB+BLE+手机生物识别组合认证，敏感操作要求用户确认",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-39",
      "verification": "单因素绕过测试"
    },
    {
      "id": "CM-IVI-020",
      "threat_ids": ["THR-IVI-015", "THR-IVI-016"],
      "name": "SecOC安全通信",
      "control_type": "prevention",
      "category": "加密",
      "description": "实施AUTOSAR SecOC规范，对CAN报文进行认证",
      "implementation": "在网关和关键ECU部署SecOC中间件，使用AES-CMAC认证报文",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-01",
      "verification": "CAN注入测试验证报文被拒绝"
    },
    {
      "id": "CM-IVI-021",
      "threat_ids": ["THR-IVI-015"],
      "name": "CAN入侵检测系统",
      "control_type": "detection",
      "category": "检测",
      "description": "部署CAN IDS检测异常报文模式",
      "implementation": "基于机器学习的异常检测，监控报文频率、ID序列、数据模式",
      "effectiveness": "medium",
      "cost": "medium",
      "priority": 2,
      "status": "in_progress",
      "iso21434_ref": "RQ-09-05",
      "verification": "异常报文检测率测试"
    },
    {
      "id": "CM-IVI-022",
      "threat_ids": ["THR-IVI-016"],
      "name": "CAN报文速率限制",
      "control_type": "prevention",
      "category": "可用性",
      "description": "限制CAN报文发送速率，防止洪泛攻击",
      "implementation": "网关实施报文速率限制和优先级管理，白名单过滤",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-12",
      "verification": "洪泛攻击测试"
    },
    {
      "id": "CM-IVI-023",
      "threat_ids": ["THR-IVI-017"],
      "name": "USB设备白名单",
      "control_type": "prevention",
      "category": "访问控制",
      "description": "限制USB设备类型，阻止未授权设备",
      "implementation": "USB设备类白名单(仅允许存储/音频)，禁用USB调试模式",
      "effectiveness": "high",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-41",
      "verification": "BadUSB设备测试"
    },
    {
      "id": "CM-IVI-024",
      "threat_ids": ["THR-IVI-018"],
      "name": "诊断安全访问增强",
      "control_type": "prevention",
      "category": "认证",
      "description": "增强UDS安全访问服务认证机制",
      "implementation": "实施基于HSM的种子密钥算法，增加失败锁定和时间限制",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-07",
      "verification": "诊断认证绕过测试"
    },
    {
      "id": "CM-IVI-025",
      "threat_ids": ["THR-IVI-018"],
      "name": "诊断会话超时",
      "control_type": "prevention",
      "category": "访问控制",
      "description": "高权限诊断会话超时自动退出",
      "implementation": "安全会话5分钟无操作自动退出，敏感操作需重新认证",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-19",
      "verification": "会话超时功能测试"
    },
    {
      "id": "CM-IVI-026",
      "threat_ids": ["THR-IVI-019", "THR-IVI-027"],
      "name": "HSM密钥保护",
      "control_type": "prevention",
      "category": "密钥管理",
      "description": "所有敏感密钥存储在HSM内部，禁止导出",
      "implementation": "使用HSM密钥生成和存储，实施密钥使用计数器和访问审计",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-10",
      "verification": "密钥提取测试"
    },
    {
      "id": "CM-IVI-027",
      "threat_ids": ["THR-IVI-019"],
      "name": "侧信道攻击防护",
      "control_type": "prevention",
      "category": "硬件安全",
      "description": "实施密码学操作侧信道防护",
      "implementation": "恒定时间算法，随机化操作时序，增加噪声屏蔽",
      "effectiveness": "medium",
      "cost": "medium",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-26",
      "verification": "DPA/SPA攻击测试"
    },
    {
      "id": "CM-IVI-028",
      "threat_ids": ["THR-IVI-020"],
      "name": "OTA固件签名验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "OTA更新前验证固件包数字签名",
      "implementation": "使用RSA-4096/ECDSA-P384签名，HSM验证签名，支持防回滚",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-08",
      "verification": "篡改固件包安装测试"
    },
    {
      "id": "CM-IVI-029",
      "threat_ids": ["THR-IVI-020"],
      "name": "OTA安全传输",
      "control_type": "prevention",
      "category": "加密",
      "description": "OTA下载过程使用安全加密通道",
      "implementation": "TLS 1.3加密下载，固件包AES加密，完整性校验",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-03",
      "verification": "MITM固件劫持测试"
    },
    {
      "id": "CM-IVI-030",
      "threat_ids": ["THR-IVI-021"],
      "name": "安全审计日志",
      "control_type": "detection",
      "category": "审计",
      "description": "记录所有安全相关事件，支持取证分析",
      "implementation": "实施安全日志系统，可信时间戳，日志完整性保护，定期上传后台",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "in_progress",
      "iso21434_ref": "RQ-09-12",
      "verification": "日志完整性测试"
    },
    {
      "id": "CM-IVI-031",
      "threat_ids": ["THR-IVI-022"],
      "name": "远程控制多因素认证",
      "control_type": "prevention",
      "category": "认证",
      "description": "敏感远程控制操作要求多因素认证",
      "implementation": "远程解锁需手机APP+PIN/生物识别，启动需额外确认",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-42",
      "verification": "单因素远程控制测试"
    },
    {
      "id": "CM-IVI-032",
      "threat_ids": ["THR-IVI-022"],
      "name": "远程指令速率限制",
      "control_type": "prevention",
      "category": "访问控制",
      "description": "限制远程控制指令频率，检测异常行为",
      "implementation": "单用户每分钟最多10次操作，异常模式检测和告警",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-43",
      "verification": "暴力攻击测试"
    },
    {
      "id": "CM-IVI-033",
      "threat_ids": ["THR-IVI-023"],
      "name": "应用签名验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "验证应用商店应用的数字签名",
      "implementation": "强制验证APK签名，拒绝未签名或签名无效的应用",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-44",
      "verification": "恶意应用安装测试"
    },
    {
      "id": "CM-IVI-034",
      "threat_ids": ["THR-IVI-023"],
      "name": "应用安全审核",
      "control_type": "prevention",
      "category": "供应链安全",
      "description": "应用商店应用上架前进行安全审核",
      "implementation": "自动化代码扫描+人工安全评审，检测恶意行为和权限滥用",
      "effectiveness": "medium",
      "cost": "high",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-45",
      "verification": "恶意应用检测率评估"
    },
    {
      "id": "CM-IVI-035",
      "threat_ids": ["THR-IVI-024"],
      "name": "用户凭证安全存储",
      "control_type": "prevention",
      "category": "加密",
      "description": "用户凭证加密存储，使用安全密钥派生",
      "implementation": "使用PBKDF2/Argon2派生存储密钥，禁止明文存储密码",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-46",
      "verification": "凭证提取测试"
    },
    {
      "id": "CM-IVI-036",
      "threat_ids": ["THR-IVI-024", "THR-IVI-022"],
      "name": "登录异常检测",
      "control_type": "detection",
      "category": "检测",
      "description": "检测异常登录行为，实施账户保护",
      "implementation": "异地登录检测，多次失败锁定，登录通知推送",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-47",
      "verification": "暴力登录测试"
    },
    {
      "id": "CM-IVI-037",
      "threat_ids": ["THR-IVI-025"],
      "name": "通讯录访问权限控制",
      "control_type": "prevention",
      "category": "隐私保护",
      "description": "严格控制应用对通讯录的访问权限",
      "implementation": "运行时权限授权，按需访问，用户可随时撤销",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-48",
      "verification": "权限绕过测试"
    },
    {
      "id": "CM-IVI-038",
      "threat_ids": ["THR-IVI-026", "THR-IVI-043"],
      "name": "行车数据加密存储",
      "control_type": "prevention",
      "category": "加密",
      "description": "行车记录视频和轨迹数据加密存储",
      "implementation": "使用AES-256加密存储，密钥绑定用户账户",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-11",
      "verification": "数据提取测试"
    },
    {
      "id": "CM-IVI-039",
      "threat_ids": ["THR-IVI-027"],
      "name": "调试接口禁用",
      "control_type": "prevention",
      "category": "访问控制",
      "description": "生产版本禁用JTAG/UART等调试接口",
      "implementation": "生产固件熔断JTAG使能位，UART需物理认证解锁",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-11",
      "verification": "调试接口访问测试"
    },
    {
      "id": "CM-IVI-040",
      "threat_ids": ["THR-IVI-028", "THR-IVI-029"],
      "name": "显示内容完整性验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "验证发送到仪表/HUD的显示数据完整性",
      "implementation": "显示指令MAC认证，异常内容检测，故障安全显示",
      "effectiveness": "medium",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-49",
      "verification": "显示篡改测试"
    },
    {
      "id": "CM-IVI-041",
      "threat_ids": ["THR-IVI-028", "THR-IVI-029"],
      "name": "仪表独立安全显示",
      "control_type": "prevention",
      "category": "隔离",
      "description": "关键仪表信息由独立安全域渲染",
      "implementation": "仪表关键数据直接从MCU安全域获取，与IVI系统隔离",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-50",
      "verification": "IVI攻破后仪表功能测试"
    },
    {
      "id": "CM-IVI-042",
      "threat_ids": ["THR-IVI-030"],
      "name": "语音指令安全验证",
      "control_type": "prevention",
      "category": "认证",
      "description": "敏感车控语音指令需额外确认",
      "implementation": "车控语音指令需屏幕确认或声纹验证，检测超声波攻击",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-51",
      "verification": "超声波指令注入测试"
    },
    {
      "id": "CM-IVI-043",
      "threat_ids": ["THR-IVI-030"],
      "name": "语音防注入滤波",
      "control_type": "prevention",
      "category": "完整性",
      "description": "过滤超声波和隐藏语音指令",
      "implementation": "语音预处理滤除非人耳可听频段，检测异常音频模式",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "planned",
      "iso21434_ref": "RQ-09-52",
      "verification": "隐藏语音指令检测测试"
    }
  ],
  "statistics": {
    "total_measures": 43,
    "by_type": {
      "prevention": 37,
      "detection": 4,
      "corrective": 1,
      "resilience": 1
    },
    "by_status": {
      "implemented": 36,
      "in_progress": 4,
      "planned": 3
    },
    "by_priority": {
      "priority_1": 28,
      "priority_2": 15
    }
  }
}
