{
  "control_measures": [
    {
      "id": "M-001",
      "name": "SecOC安全通信",
      "control_type": "prevention",
      "category": "加密",
      "description": "实施AUTOSAR SecOC规范，对CAN/CAN-FD报文进行认证",
      "implementation": "在网关和关键ECU上部署SecOC中间件，使用AES-CMAC进行报文认证",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-01",
      "threat_ids": ["T-002", "T-007"]
    },
    {
      "id": "M-002",
      "name": "TLS/DTLS加密通信",
      "control_type": "prevention",
      "category": "加密",
      "description": "对T-Box与云端之间的通信使用TLS 1.3加密",
      "implementation": "部署TLS 1.3，使用证书双向认证，定期轮换会话密钥",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-03",
      "threat_ids": ["T-003", "T-009"]
    },
    {
      "id": "M-003",
      "name": "安全启动验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "实施安全启动链，验证固件签名",
      "implementation": "使用HSM存储根密钥，逐级验证Bootloader和应用程序签名",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-04",
      "threat_ids": ["T-006", "T-009"]
    },
    {
      "id": "M-004",
      "name": "入侵检测系统 (IDS)",
      "control_type": "detection",
      "category": "检测",
      "description": "部署车载网络入侵检测系统，监控异常CAN报文",
      "implementation": "基于机器学习的CAN IDS，实时检测报文频率和内容异常",
      "effectiveness": "medium",
      "cost": "medium",
      "priority": 2,
      "status": "in_progress",
      "iso21434_ref": "RQ-09-05",
      "threat_ids": ["T-002", "T-008"]
    },
    {
      "id": "M-005",
      "name": "诊断访问控制",
      "control_type": "prevention",
      "category": "隔离",
      "description": "实施UDS安全访问服务(0x27)，限制诊断功能访问",
      "implementation": "使用种子-密钥机制，结合时间限制和失败锁定策略",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-07",
      "threat_ids": ["T-007"]
    },
    {
      "id": "M-006",
      "name": "固件签名验证",
      "control_type": "prevention",
      "category": "完整性",
      "description": "OTA更新前验证固件数字签名",
      "implementation": "使用RSA-2048/ECDSA签名，HSM验证，支持回滚保护",
      "effectiveness": "high",
      "cost": "low",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-08",
      "threat_ids": ["T-009"]
    },
    {
      "id": "M-007",
      "name": "蓝牙安全配对",
      "control_type": "prevention",
      "category": "加密",
      "description": "强制使用安全配对模式，禁用传统配对",
      "implementation": "启用Secure Simple Pairing (SSP)，使用ECDH密钥交换",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-09",
      "threat_ids": ["T-001"]
    },
    {
      "id": "M-008",
      "name": "网络分段隔离",
      "control_type": "prevention",
      "category": "隔离",
      "description": "通过网关实施域间通信隔离和访问控制",
      "implementation": "配置网关防火墙规则，限制跨域通信，实施白名单策略",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-10",
      "threat_ids": ["T-002", "T-008"]
    },
    {
      "id": "M-009",
      "name": "数据加密存储",
      "control_type": "prevention",
      "category": "加密",
      "description": "对敏感数据进行加密存储",
      "implementation": "使用AES-256-GCM加密存储用户数据和密钥材料",
      "effectiveness": "high",
      "cost": "low",
      "priority": 2,
      "status": "implemented",
      "iso21434_ref": "RQ-09-11",
      "threat_ids": ["T-003", "T-010"]
    },
    {
      "id": "M-010",
      "name": "安全日志审计",
      "control_type": "detection",
      "category": "检测",
      "description": "记录安全相关事件，支持取证分析",
      "implementation": "实施安全日志系统，定期上传至后台进行分析",
      "effectiveness": "medium",
      "cost": "low",
      "priority": 3,
      "status": "planned",
      "iso21434_ref": "RQ-09-12",
      "threat_ids": ["T-001", "T-002", "T-005"]
    },
    {
      "id": "M-011",
      "name": "传感器冗余校验",
      "control_type": "prevention",
      "category": "完整性",
      "description": "使用多传感器融合，检测单一传感器欺骗",
      "implementation": "摄像头、雷达、激光雷达数据融合校验，异常时降级处理",
      "effectiveness": "high",
      "cost": "high",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-13",
      "threat_ids": ["T-004"]
    },
    {
      "id": "M-012",
      "name": "钥匙信号加密",
      "control_type": "prevention",
      "category": "加密",
      "description": "对无钥匙进入系统信号进行加密和滚动码保护",
      "implementation": "使用AES-128加密，实施滚动码和时间戳防重放",
      "effectiveness": "high",
      "cost": "medium",
      "priority": 1,
      "status": "implemented",
      "iso21434_ref": "RQ-09-14",
      "threat_ids": ["T-005"]
    }
  ]
}
